<app-navbar></app-navbar>
<div class="providers-status">
  <div class="header">
    <h2>Service Providers Status</h2>
    <span [ngClass]="topStatusClass">{{ topStatusLabel }}</span>
  </div>

  <div class="tabs" role="tablist">
    <button
      *ngFor="let t of tabs"
      type="button"
      class="tab"
      [class.active]="t === activeFilter"
      (click)="setFilter(t)"
      [attr.aria-pressed]="t === activeFilter"
    >
      {{ t }}
    </button>
  </div>

  <table class="providers-table">
    <thead>
      <tr>
        <th>Service Provider</th>
        <th>Owner</th>
        <th>Date</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let sp of service" (click)="goTo(sp.id)">
        <td>{{ sp.id }}</td>
        <td>{{ sp.first_name + sp.last_name }}</td>
        <td>{{ sp.service_provider.updated_at | date : "mediumDate" }}</td>
        <td>
          <ng-container *ngIf="activeFilter === 'Pending'; else normalStatus">
            <div class="pending-actions">
              <button
                type="button"
                class="action-btn approve"
                (click)="approveOrdecline(sp.id, 1, '')"
              >
                Approve
              </button>
              <button
                type="button"
                class="action-btn decline"
                (click)="approveOrdecline(sp.id, 0, '')"
              >
                Decline
              </button>
            </div>
          </ng-container>

          <ng-template #normalStatus>
            <span class="status" [ngClass]="activeFilter.toLowerCase()">
              {{ activeFilter }}
            </span>
          </ng-template>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Mobile -->
  <div class="providers-cards">
    <div class="provider-card" *ngFor="let sp of service">
      <div class="row">
        <span class="label">Service Provider:</span>
        <span class="value">{{ sp.id }}</span>
      </div>
      <div class="row">
        <span class="label">Owner:</span>
        <span class="value">{{ sp.first_name + sp.last_name }}</span>
      </div>
      <div class="row">
        <span class="label">Date:</span>
        <span class="value">{{
          sp.service_provider.updated_at | date : "mediumDate"
        }}</span>
      </div>
      <div class="row">
        <span class="label">Status:</span>
        <span class="value">
          <ng-container
            *ngIf="activeFilter === 'Pending'; else normalStatusMobile"
          >
            <div class="actions">
              <button
                type="button"
                class="action-btn approve"
                (click)="approveOrdecline(sp.id, 1, '')"
              >
                Approve
              </button>
              <button
                type="button"
                class="action-btn decline"
                (click)="approveOrdecline(sp.id, 0, '')"
              >
                Decline
              </button>
            </div>
          </ng-container>

          <ng-template #normalStatusMobile>
            <span class="status" [ngClass]="activeFilter.toLowerCase()">
              {{ activeFilter }}
            </span>
          </ng-template>
        </span>
      </div>
    </div>
  </div>
</div>
