<div class="dashboard-grid">
  <div class="kpi-grid kpi_chart">
    <article class="kpi-card" role="listitem" aria-labelledby="kpi1-title">
      <div>
        <div class="kpi-top">
          <div>
            <div id="kpi1-title" class="kpi-title">Total Users</div>
          </div>
          <img class="add-icon" src="Icons\purple.svg" alt="" />
        </div>

        <div *ngIf="totalUsers" class="kpi-value">
          {{ totalUsers.total }} Users
        </div>
      </div>
    </article>
    <article class="kpi-card" role="listitem" aria-labelledby="kpi2-title">
      <div>
        <div class="kpi-top">
          <div>
            <div id="kpi2-title" class="kpi-title">Total Properties</div>
          </div>
          <img class="add-icon" src="Icons\yellow.svg" alt="" />
        </div>

        <div *ngIf="totalProperties" class="kpi-value">
          {{ totalProperties.total }} Properties
        </div>
      </div>
    </article>
    <article class="kpi-card" role="listitem" aria-labelledby="kpi3-title">
      <div>
        <div class="kpi-top">
          <div>
            <div id="kpi3-title" class="kpi-title">Total Services</div>
          </div>
          <img class="add-icon" src="Icons\green.svg" alt="" />
        </div>

        <div *ngIf="totalUsers" class="kpi-value">
          {{ totalUsers.service_providers }} Providers
        </div>
      </div>
    </article>

    <article class="kpi-card" role="listitem" aria-labelledby="kpi4-title">
      <div>
        <div class="kpi-top">
          <div>
            <div id="kpi4-title" class="kpi-title">Total Pending</div>
          </div>
          <img class="add-icon" src="Icons\red.svg" alt="" />
        </div>

        <div *ngIf="propertiesStatus" class="kpi-value">
          {{ propertiesStatus.pending }} Requests
        </div>
      </div>
    </article>
  </div>

  <!-- donut -->
  <div class="card donut_chart">
    <div class="card-title">Properties Types</div>

    <div class="chart-wrapper" style="position: relative">
      <div *ngIf="donutOptions; else donutLoading">
        <div
          echarts
          [options]="donutOptions"
          (chartInit)="onChartInit($event)"
          class="chart"
          aria-label="Properties chart"
        ></div>

        <button
          *ngIf="activeView === 'groups'"
          type="button"
          class="side-arrow arrow-right"
          (click)="switchView('top')"
          aria-label="Show sale types"
          title="Sale types"
        >
          <span class="arrow" aria-hidden="true">➜</span>
          <span class="arrow-label">{{ "Sale types" }}</span>
        </button>

        <button
          *ngIf="activeView === 'top'"
          type="button"
          class="side-arrow arrow-left"
          (click)="switchView('groups')"
          aria-label="Show property types"
          title="Property types"
        >
          <span class="arrow" aria-hidden="true">➜</span>
          <span class="arrow-label">{{ "Property types" }}</span>
        </button>
      </div>

      <ng-template #donutLoading>
        <div class="loading">Loading chart…</div>
      </ng-template>

      <div class="summary" *ngIf="totalProperties">
        <div><strong>Total:</strong> {{ totalProperties.total }}</div>
        <div *ngIf="activeView === 'groups'">
          <strong>Residential:</strong>
          {{ totalProperties.residential.total }},
          <strong>Commercial:</strong>
          {{ totalProperties.commercial.total }}
        </div>
        <div *ngIf="activeView === 'top'">
          <strong>Off-plan:</strong> {{ totalProperties?.['off-plan']}},
          <strong>Purchase:</strong> {{ totalProperties.purchase }},
          <strong>Rent:</strong> {{ totalProperties.rent }}
        </div>
      </div>
    </div>
  </div>

  <div class="card bar_chart">
    <div class="card-title">Properties Location</div>
    <div echarts [options]="barOptions" class="chart"></div>
  </div>

  <!-- <div class="card wide line_chart">
    <div class="card-title">Monthly updates</div>
    <div echarts [options]="lineOptions" class="chart"></div>
  </div> -->
</div>
